-- V3: create T_CONTRACT_DETAIL 

CREATE TABLE T_CONTRACT_DETAIL (
    ID                          VARCHAR2(255) NOT NULL,
    CREATE_TIME                 TIMESTAMP,
    CREATE_USER                 VARCHAR2(255),
    CREATE_USERIP               VARCHAR2(255),
    DELETED                     VARCHAR2(255),
    UPDATE_TIME                 TIMESTAMP,
    UPDATE_USER                 VARCHAR2(255),
    UPDATE_USERIP               VARCHAR2(255),
    VERSION                     NUMBER(10,0),
    ACTIVE                      VARCHAR2(255),
    ACTUAL_START_DATE           DATE,
    AUTO_ID                     NUMBER(19,0),
    BILL_START_DATE             DATE,
    BILLING_CODE                VARCHAR2(255),
    CONTRACT_DETAIL_STATUS      VARCHAR2(255),
    END_DATE                    DATE,
    IS_PART_OF_BUNDLE           VARCHAR2(255),
    OPERATION_DATE              TIMESTAMP,
    OPERATION_DESCRIPTION       VARCHAR2(255),
    OPERATION_TYPE              VARCHAR2(255),
    QUANTITY                    NUMBER(10,0),
    START_DATE                  DATE,
    STATUS_CHANGE_DATE          TIMESTAMP,
    TSFA_PROPOSAL_ID            VARCHAR2(255),
    TSFA_SALES_ID               VARCHAR2(255),
    COMMITED_CONTRACT_DETAIL_ID VARCHAR2(255),
    CONTRACT_ID                 VARCHAR2(255),
    CONTRACT_DETAIL_COMMITMENT  VARCHAR2(255),
    CONTRACT_DETAIL_PRICE       VARCHAR2(255),
    CUSTOMER_ID                 VARCHAR2(255),
    BILLING_ACCOUNT_ID          VARCHAR2(255),
    DELIVERY_ADDRESS_ID         VARCHAR2(255),
    OFFER_ID                    VARCHAR2(255),
    OFFER_RELATION_ID           VARCHAR2(255),
    PARENT_CONTRACT_DETAIL_ID   VARCHAR2(255),
    TRANSITION_CONTRACT_DETAIL_ID VARCHAR2(255),
    MIG_STATUS                  VARCHAR2(2),
    MIG_DATE                    DATE,
    CREATE_DEALER               VARCHAR2(255),
    SALES_DATE                  TIMESTAMP,
    SERVICE_BARRING             VARCHAR2(255),
    NOBLG                       NUMBER,
    TURKCELL_MSISDN             VARCHAR2(32),
    EMPTOR_FLOW_STATUS          VARCHAR2(50),
    CROSS_SALE_DEFINITION_ID    VARCHAR2(255),
    CROSS_SALE_PRIMARY_ID       VARCHAR2(255),
    IS_DISCOUNT_APPLIED         VARCHAR2(10),
    LOCK_TYPE                   VARCHAR2(50),
    TRANSITION_TYPE             VARCHAR2(40),
    DEALER_TYPE                 VARCHAR2(150),
    DEALER_NAME                 VARCHAR2(255),
    USER_DISPLAY_NAME           VARCHAR2(255),
    CHANNEL_ID                  CHAR(36),
    TAKEOVER_TRANSITION_CD_ID   CHAR(36),
    ORGANIZATION_ID             VARCHAR2(255),

    CONSTRAINT PK_T_CONTRACT_DETAIL PRIMARY KEY (ID),

    /* CHECK constraints (ekran görüntülerindeki kurallar) */
    CONSTRAINT CHK_CD_STATUS_END_DATE
      CHECK (NOT (CONTRACT_DETAIL_STATUS = 'DEACT_END' AND END_DATE IS NULL)),

    CONSTRAINT CHK_EMPTOR_FLOW_STATUS
      CHECK (EMPTOR_FLOW_STATUS IN ('OPEN','CLOSED')),

    CONSTRAINT CHK_ACTIVE_T_CONTRACT_DETAIL
      CHECK (ACTIVE IN ('YES','NO','UNDEFINED')),

    CONSTRAINT CHK_IS_PART_OF_BUNDLE
      CHECK (IS_PART_OF_BUNDLE IN ('YES','NO','UNDEFINED')),

    CONSTRAINT CHK_CONTRACT_DETAIL_STATUS
      CHECK (CONTRACT_DETAIL_STATUS IN (
        'ACT_INPROGRESS','ACT_END',
        'DEACT_INPROGRESS','DEACT_END',
        'SUSPEND_INPROGRESS','SUSPEND_END',
        'RESUME_INPROGRESS',
        'CANCELLATION_INPROGRESS','CANCELLATION_END'
      )),

    CONSTRAINT CHK_SERVICE_BARRING
      CHECK (SERVICE_BARRING IN ('YES','NO','SUSPEND','DEACT'))
);

